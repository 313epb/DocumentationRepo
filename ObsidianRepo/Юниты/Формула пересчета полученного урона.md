Dmg * Def  - урон модифицированный защитой
Atck - попавшая атака 
***Вариант 1***

foreach Atk (
currmodelhp-=
(Dmg x Def)>CurrHp? currhp : Dmg x Def
if currmodelhp=0
(modelcount-=1
if modelcount=0 break
else currhp=baseModelHp
)
)

Каждая атака может убить только одного юнита.

***Вариант 2***
currHpPool-=Atck * DmG * Def
modelCount=currHpPool/modelHp 
Весь урон прилетает в отряд целиком, вычитаем потери  считаем потери
